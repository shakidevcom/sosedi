!function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/",o(o.s=8)}({8:function(t,e,o){t.exports=o("zVwF")},zVwF:function(t,e,o){"use strict";self.addEventListener("push",(function(t){if(console.log("[Service Worker] Push Received."),t.data){console.log('[Service Worker] Push data: "'.concat(t.data.text(),'"'));var e="Новое уведомление 2 shakidev.com",o={body:"Вышла новость. Читайте свежие новости на нашем сайте.",tag:"shakidev-news-v1",icon:"https://shakidev.com/images/map-point.png",data:{title:e,url:"https://www.shakidev.com"}},n=t.data.json();1==n.v&&(e=n.msg.title,o.body=n.msg.msg,o.icon=n.msg.icon,n.msg.image&&(o.image=n.msg.image),o.tag=n.msg.tag,o.data.url=n.msg.url,o.badge=n.msg.badge),console.log("notify options:",o);var i=self.registration.showNotification(e,o);t.waitUntil(i)}else{if(!self.Notification||"granted"!==self.Notification.permission)return void console.log("PushNotification permission problem");fetch("/last.php").then((function(t){if(200!==t.status)throw new Error;return t.json().then((function(t){if(t.error||!t.notification)throw console.log("must throw error"),new Error;return function(t,e,o,n,i){return t=t||"shakidev.com",e=e||"Новое уведомление",o=o||"https://shakidev.com/images/map-point.png",n=n||"shakidev.com-maps",i=i||"http://shakidev.com",self.registration.showNotification(t,{body:e,icon:o,tag:n,data:{title:t,url:i}})}(t.title,t.msg,t.icon,t.tag,t.url)}))})).catch((function(t){console.log("Some error at fetch:"),console.log(t)}))}})),self.addEventListener("notificationclick",(function(t){console.log("[Service Worker] Notification click Received."),t.notification.close();var e=t.notification.url;t.notification.data&&(e=e||t.notification.data.url),e=e||"https://www.shakidev.com/",console.log("[Service Worker] Notification click url:",e),t.waitUntil(clients.matchAll({type:"window"}).then((function(t){for(var o=0;o<t.length;o++){var n=t[o];if(n.url===e&&"focus"in n)return n.focus()}if(clients.openWindow)return clients.openWindow(e)})))}))}});